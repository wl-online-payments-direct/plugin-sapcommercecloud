<?xml version="1.0" encoding="UTF-8"?>
<!--
 Copyright (c) 2019 SAP SE or an SAP affiliate company. All rights reserved.
-->
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans.xsd
           http://www.springframework.org/schema/aop
           http://www.springframework.org/schema/aop/spring-aop.xsd
           http://www.springframework.org/schema/context
           http://www.springframework.org/schema/context/spring-context.xsd">
           
    <context:annotation-config/>

	<context:component-scan base-package="com.ingenico.ogone.direct"/>

    <alias name="defaultIngenicoB2CResponsiveMultiStepCheckout" alias="ingenicoB2CResponsiveMultiStepCheckout" />
    <bean id="defaultIngenicoB2CResponsiveMultiStepCheckout" parent="checkoutStep">
        <property name="checkoutGroup" ref="ingenicoB2CResponsiveCheckoutGroup"/>
        <property name="checkoutStepValidator" ref="defaultResponsiveMultiStepCheckoutValidator"/>
        <property name="transitions">
            <map>
                <entry key="previous" value-ref="REDIRECT_TO_CART"/>
                <entry key="current" value-ref="REDIRECT_MULTI_STEP_CHECKOUT"/>
                <entry key="next" value-ref="REDIRECT_TO_DELIVERY_ADDRESS"/>
            </map>
        </property>
        <property name="progressBarId" value="multi"/>
    </bean>

    <alias name="defaultIngenicoB2CResponsiveDeliveryAddressCheckoutStep" alias="ingenicoB2CResponsiveDeliveryAddressCheckoutStep" />
    <bean id="defaultIngenicoB2CResponsiveDeliveryAddressCheckoutStep" parent="checkoutStep">
        <property name="checkoutGroup" ref="ingenicoB2CResponsiveCheckoutGroup"/>
        <property name="checkoutStepValidator" ref="defaultResponsiveDeliveryAddressCheckoutValidator"/>
        <property name="transitions">
            <map merge="true">
                <entry key="previous" value-ref="REDIRECT_TO_CART"/>
                <entry key="current" value-ref="REDIRECT_TO_DELIVERY_ADDRESS"/>
                <entry key="next" value-ref="REDIRECT_TO_DELIVERY_METHOD"/>
            </map>
        </property>
        <property name="progressBarId" value="deliveryAddress"/>
    </bean>

    <alias name="defaultIngenicoB2CResponsiveDeliveryMethodCheckoutStep" alias="ingenicoB2CResponsiveDeliveryMethodCheckoutStep" />
    <bean id="defaultIngenicoB2CResponsiveDeliveryMethodCheckoutStep"  parent="checkoutStep">
        <property name="checkoutGroup" ref="ingenicoB2CResponsiveCheckoutGroup"/>
        <property name="checkoutStepValidator" ref="defaultResponsiveDeliveryMethodCheckoutValidator"/>
        <property name="transitions">
            <map merge="true">
                <entry key="previous" value-ref="REDIRECT_TO_DELIVERY_ADDRESS"/>
                <entry key="current" value-ref="REDIRECT_TO_DELIVERY_METHOD"/>
                <entry key="next" value-ref="REDIRECT_TO_PAYMENT_METHOD_INGENICO"/>
            </map>
        </property>
        <property name="progressBarId" value="deliveryMethod"/>
    </bean>

    <alias name="defaultIngenicoB2CResponsiveChoosePaymentCheckoutStep" alias="ingenicoB2CResponsiveChoosePaymentCheckoutStep"/>
    <bean id="defaultIngenicoB2CResponsiveChoosePaymentCheckoutStep" parent="checkoutStep">
        <property name="checkoutGroup" ref="ingenicoB2CResponsiveCheckoutGroup"/>
        <property name="checkoutStepValidator" ref="defaultPaymentMethodCheckoutValidator"/>
        <property name="transitions">
            <map merge="true">
                <entry key="previous" value-ref="REDIRECT_TO_DELIVERY_METHOD"/>
                <entry key="current" value-ref="REDIRECT_TO_PAYMENT_METHOD_INGENICO"/>
                <entry key="next" value-ref="REDIRECT_TO_SUMMARY_INGENICO"/>
            </map>
        </property>
        <property name="progressBarId" value="paymentMethod"/>
    </bean>

    <alias name="defaultIngenicoB2CResponsiveSummaryCheckoutStep" alias="ingenicoB2CResponsiveSummaryCheckoutStep" />
    <bean id="defaultIngenicoB2CResponsiveSummaryCheckoutStep"  parent="checkoutStep">
        <property name="checkoutGroup" ref="ingenicoB2CResponsiveCheckoutGroup"/>
        <property name="checkoutStepValidator" ref="defaultResponsiveSummaryCheckoutValidator"/>
        <property name="transitions">
            <map merge="true">
                <entry key="previous" value-ref="REDIRECT_TO_PAYMENT_METHOD_INGENICO"/>
                <entry key="current" value-ref="REDIRECT_TO_SUMMARY_INGENICO"/>
                <entry key="next" value="REDIRECT_TO_ORDER_CONFIRMATION_INGENICO"/>
            </map>
        </property>
        <property name="progressBarId" value="confirmOrder"/>
    </bean>

    <alias name="defaultIngenicoB2CResponsiveDoPaymentCheckoutStep" alias="ingenicoB2CResponsiveDoPaymentCheckoutStep" />
    <bean id="defaultIngenicoB2CResponsiveDoPaymentCheckoutStep"  parent="checkoutStep">
        <property name="checkoutGroup" ref="ingenicoB2CResponsiveCheckoutGroup"/>
        <property name="checkoutStepValidator" ref="ingenicoPaymentWithTokenCheckoutStepValidator"/>
        <property name="transitions">
            <map merge="true">
                <entry key="previous" value-ref="REDIRECT_TO_SUMMARY_INGENICO"/>
                <entry key="current" value-ref="REDIRECT_TO_PAYMENT_INGENICO"/>
                <entry key="next" value="REDIRECT_TO_ORDER_CONFIRMATION_INGENICO"/>
            </map>
        </property>
        <property name="progressBarId" value="confirmOrder"/>
    </bean>


    <bean id="ingenicoB2CResponsiveCheckoutGroup"  class="de.hybris.platform.acceleratorstorefrontcommons.checkout.steps.CheckoutGroup">
        <property name="groupId"  value="ingenicoB2CResponsiveCheckoutGroup"/>
        <property name="checkoutStepMap">
            <map merge="true">
                <entry key="multi" value-ref="ingenicoB2CResponsiveMultiStepCheckout"/>
                <entry key="delivery-address" value-ref="ingenicoB2CResponsiveDeliveryAddressCheckoutStep"/>
                <entry key="delivery-method" value-ref="ingenicoB2CResponsiveDeliveryMethodCheckoutStep"/>
                <entry key="choose-payment-method" value-ref="ingenicoB2CResponsiveChoosePaymentCheckoutStep"/>
                <entry key="summary" value-ref="ingenicoB2CResponsiveSummaryCheckoutStep"/>
                <entry key="do-payment" value-ref="ingenicoB2CResponsiveDoPaymentCheckoutStep"/>
            </map>
        </property>
        <property name="validationResultsMap">
            <map merge="true">
                <entry key="FAILED" value-ref="REDIRECT_TO_CART"/>
                <entry key="REDIRECT_TO_DELIVERY_ADDRESS" value-ref="REDIRECT_TO_DELIVERY_ADDRESS"/>
                <entry key="REDIRECT_TO_CART" value-ref="REDIRECT_TO_CART"/>
                <entry key="REDIRECT_TO_PAYMENT_METHOD" value-ref="REDIRECT_TO_PAYMENT_METHOD_INGENICO"/>
                <entry key="REDIRECT_TO_DELIVERY_METHOD" value-ref="REDIRECT_TO_DELIVERY_METHOD"/>
                <entry key="REDIRECT_TO_SUMMARY" value-ref="REDIRECT_TO_SUMMARY_INGENICO"/>
            </map>
        </property>
        <property name="checkoutProgressBar">
            <map merge="true">
                <entry key="1" value-ref="ingenicoB2CResponsiveDeliveryAddressCheckoutStep"/>
                <entry key="2" value-ref="ingenicoB2CResponsiveDeliveryMethodCheckoutStep"/>
                <entry key="3" value-ref="ingenicoB2CResponsiveChoosePaymentCheckoutStep"/>
                <entry key="4" value-ref="ingenicoB2CResponsiveSummaryCheckoutStep"/>
            </map>
        </property>
    </bean>



    <bean id="ingenicoCheckoutFlowGroupResponsiveMapMergeDirective" parent="mapMergeDirective" depends-on="checkoutFlowGroupMap">
        <property name="key" value="ingenicoB2CResponsiveCheckoutGroup"/>
        <property name="value" ref="ingenicoB2CResponsiveCheckoutGroup"/>
    </bean>

    <bean id="ingenicoPaymentWithTokenCheckoutStepValidator" class="com.ingenico.ogone.direct.checkout.steps.validation.impl.IngenicoPaymentWithTokenCheckoutStepValidator" parent="abstractCheckoutStepValidator" >
        <property name="ingenicoCheckoutFlowFacade" ref="ingenicoCheckoutFlowFacade"/>
    </bean>


    <bean id="REDIRECT_TO_SUMMARY_INGENICO" class="java.lang.String">
        <constructor-arg value="redirect:/checkout/multi/ingenico/summary/view"/>
    </bean>

    <bean id="REDIRECT_TO_PAYMENT_METHOD_INGENICO" class="java.lang.String">
        <constructor-arg value="redirect:/checkout/multi/ingenico/select-payment-method"/>
    </bean>

    <bean id="REDIRECT_TO_PAYMENT_INGENICO" class="java.lang.String">
        <constructor-arg value="redirect:/checkout/multi/ingenico/payment/view"/>
    </bean>

    <bean id="REDIRECT_TO_ORDER_CONFIRMATION_INGENICO" class="java.lang.String">
        <constructor-arg value="redirect:/checkout/ingenico/orderConfirmation/%s"/>
    </bean>


</beans>
