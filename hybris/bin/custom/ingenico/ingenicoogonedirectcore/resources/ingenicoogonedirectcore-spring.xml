<?xml version="1.0" encoding="UTF-8"?>
<!--
 Copyright (c) 2020 SAP SE or an SAP affiliate company. All rights reserved.
-->
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
            http://www.springframework.org/schema/beans/spring-beans.xsd
            http://www.springframework.org/schema/util
            http://www.springframework.org/schema/util/spring-util.xsd">

    <import resource="ingenicoogonedirectcore-spring-dao.xml"/>
    <import resource="ingenicoogonedirectcore-spring-service.xml"/>
    <import resource="ingenicoogonedirectcore-spring-converter.xml"/>


    <bean id="ingenicoClientFactory" class="com.ingenico.ogone.direct.factory.impl.IngenicoClientFactoryImpl">
        <property name="ingenicoConfigurationService" ref="ingenicoConfigurationService"/>
        <property name="communicatorConfiguration" ref="communicatorConfiguration"/>
    </bean>

    <bean id="communicatorConfiguration" class="com.ingenico.direct.CommunicatorConfiguration">
        <property name="authorizationType"
                  value="#{configurationService.configuration.getProperty('ingenico.direct.api.authorizationType')}"/>
        <property name="connectTimeout"
                  value="#{configurationService.configuration.getProperty('ingenico.direct.api.connectTimeout')}"/>
        <property name="socketTimeout"
                  value="#{configurationService.configuration.getProperty('ingenico.direct.api.socketTimeout')}"/>
        <property name="maxConnections"
                  value="#{configurationService.configuration.getProperty('ingenico.direct.api.maxConnections')}"/>
        <property name="integrator"
                  value="#{configurationService.configuration.getProperty('ingenico.direct.api.integrator')}"/>
    </bean>
    <!-- utils -->

    <bean id="ingenicoAmountUtils" class="com.ingenico.ogone.direct.util.IngenicoAmountUtils">
        <property name="commonI18NService" ref="commonI18NService"/>
    </bean>

    <!-- facades -->
    <bean id="ingenicoUserFacade" class="com.ingenico.ogone.direct.facade.impl.IngenicoUserFacadeImpl">
        <property name="modelService" ref="modelService"/>
        <property name="checkoutCustomerStrategy" ref="checkoutCustomerStrategy"/>
        <property name="ingenicoCustomerAccountService" ref="ingenicoCustomerAccountService"/>
        <property name="ingenicoPaymentInfoConverter" ref="ingenicoPaymentInfoConverter"/>
    </bean>

    <bean id="ingenicoCheckoutFacade" class="com.ingenico.ogone.direct.facade.impl.IngenicoCheckoutFacadeImpl">
        <property name="commonI18NService" ref="commonI18NService"/>
        <property name="checkoutFacade" ref="checkoutFacade"/>
        <property name="ingenicoUserFacade" ref="ingenicoUserFacade"/>
        <property name="ingenicoPaymentService" ref="ingenicoPaymentService"/>
        <property name="ingenicoTransactionService" ref="ingenicoTransactionService"/>
        <property name="addressReverseConverter" ref="addressReverseConverter"/>
        <property name="cartService" ref="cartService"/>
        <property name="commerceCheckoutService" ref="commerceCheckoutService"/>
        <property name="modelService" ref="modelService"/>
        <property name="baseStoreService" ref="baseStoreService"/>
    </bean>

    <bean id="ingenicoWebhookFacade" class="com.ingenico.ogone.direct.facade.impl.IngenicoWebhookFacadeImpl">
        <property name="ingenicoWebhookService" ref="ingenicoWebhookService"/>
    </bean>

    <!-- Job -->
    <bean id="ingenicoProcessWebhooksEventJob" class="com.ingenico.ogone.direct.cronjob.IngenicoProcessWebhooksEventJob" parent="abstractJobPerformable">
        <property name="modelService" ref="modelService" />
        <property name="ingenicoWebhookService" ref="ingenicoWebhookService" />
        <property name="ingenicoWebhookDao" ref="ingenicoWebhookDao" />
    </bean>

    <!-- strategies -->
    <alias alias="createOrderFromCartStrategy" name="defaultIngenicoCreateOrderFromCartStrategy"/>
    <bean id="defaultIngenicoCreateOrderFromCartStrategy"
          class="com.ingenico.ogone.direct.strategy.impl.DefaultIngenicoCreateOrderFromCartStrategy" parent="defaultCreateOrderFromCartStrategy">
    </bean>


</beans>